|変更日|バージョン|変更者|変更内容|
|---|---|---|---|
||1.0|22 瀬古大介||
|2023/12/18|2.0|23 前田陽祐|役者の総稽古時間のカウントを"=countif(INDIRECT(R4&"!J2:P12"),"参加")"に変更。役者名を入力しなくてもいいように。  <br>  <br>総稽古時間のカウントに条件付き書式を適応。多い人ほど色が濃い。セルを選択して「表示形式→条件付き書式→カラースケール」で、色を「白→緑」などにする。  <br>範囲を変更して、役者の稽古時間だけを比較するなども可。  <br>  <br>演出助手と役者の原本を統合。演出助手は下にチェックを入れるようにする。  <br>テンプレートからApps Scriptで人数分のシートを作成できるようにした。  <br>実行後は#REF!が出るが、シート全体を選択してctrl + C → ctrl + VでOK。  <br>  <br>少人数稽古のシートの初期設定を簡便にした。=IF(INDIRECT($M$1)=TRUE,INDIRECT($L$1 & "!" & B16),)に変更。人の名前だけでなく、チェックボックスのセルの位置を記載する必要があることに注意。  <br>人を追加する場合は、日時の左上の部分のみをコピーして人名とセル位置とB16を合わせる。その後オートフィルでH26まで埋める。  <br>  <br>全体稽古のカウントの初期設定を簡便にした。シート下部に全員分の出席可能時間を転記して、それの和を取るように変更。  <br>  <br>全体的に人数の増減に対応できるようにした。  <br>  <br>曜日の上に日付を表示。全体稽古のシートで月曜日の日付を入力すればOK.|
|2023/12/20|2.1|23 前田陽祐|少人数稽古のシートを修正。全体稽古と同じ方式で、黒塗り部にIFをつけた。  <br>  <br>集計の表示が一つ下にずれる問題を解決。集計のセルは文字列で指定しているので、変更に対してやや脆弱。|
|2024/1/12|2.2|23 前田陽祐|全体稽古で作演ON時にカウントが変わる問題に対処。  <br>人数の増減に対応するための欄に数字が入力されていた。理由はわからない。おそらく定義されていないシートの参照に関するもの。Google側の問題か。  <br>名前が入力されていない場合は0になるようにして、名前が入力されている時のみ参照するようにした。|

## Ver 2.3
Ver 2.2では15人までの対応だったが、新歓に伴い同様のスプシの対応人数を増やす必要が生まれた。よって、これを機に対応人数を無制限にできないか検討。
### アプローチ
- 合計の計算に使用している部分を別のシートに移動する
- 計算用のシートの1列全てを足すようにする
	- 全体稽古のシートで `=SUM($B$20:$B$34)` のように記述していたのを、`=SUM('計算用'!B:B)`のように変更。
	- 一括して変更するために、正規表現を用いた検索置換を行った。
		- 検索と置換ウィンドウを開き、「正規表現を使用した検索」「数式内も検索」をオンにする
		- 検索対象を`\$([A-Z]{1,2})\$\d+:\$\1\$\d+`にする
		- 置換後の文字列を`'計算用'!$1:$1`にする
		
時間単位での日程調整がしたいなら[[スケジュール調整ツール『トントン』]]を使えばいいのではないか？